<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.fms.service.mapper.IndexServiceMapper" >
   <!-- 通讯录条件查询 -->
   <sql id="queryListComRosterCondition">
     <if test='chnName!= null and chnName!=""'>
			AND A.AGENT_NAME = #{chnName}
		</if>
		<if test='mobile!= null and mobile!=""'>
			AND A.MOBILE = #{mobile}
		</if>
		<if test='officeTel!= null and officeTel!=""'>
			AND A.OFFICE_TEL = #{officeTel}
		</if>
   </sql>
   <!-- 获取公司政策列表 -->
<select id="queryComPolicyList" parameterType="java.util.Map" resultType="java.util.Map">
         		SELECT
	a.COMPANY_POLICY_INFO_ID 'companyPolicyInfoId',
	a.TITLE 'title',
  DATE_FORMAT(a.MODIFY_DATE,'%Y-%m-%d') 'modifyDate'
	FROM
	t_company_policy_info a
	WHERE
	1 = 1
	AND a.RC_STATE = 'E'
	ORDER BY
	a.MODIFY_DATE DESC
	LIMIT #{startIndex} , #{endIndex}
</select> 
    
    <select id="queryComPolicyListCount" parameterType="java.util.Map" resultType="java.lang.Integer">
		SELECT COUNT(1)
        FROM t_company_policy_info a
        WHERE 1=1
        AND A.RC_STATE = 'E'
    </select> 
    <!-- 获取公司政策内容 -->
 <select id="getCompanyPolicyContext" parameterType="java.util.Map"
	resultType="java.util.Map">
	SELECT
	a.TITLE 'title',
	a.CONTENT 'context'
	FROM
	t_company_policy_info a
	WHERE
	1 = 1
	AND a.RC_STATE = 'E'
	AND a.COMPANY_POLICY_INFO_ID = #{companyPolicyInfoId}
</select> 
    <!-- 获取行业新闻信息 -->
    <select id="getProfessionNewsContext" parameterType="java.util.Map"
	resultType="java.util.Map">
	SELECT a.TITLE 'title',
	a.CONTENT 'context'
	from t_profession_news_info a
	where 1=1
	and a.RC_STATE = 'E'
	and a.PROFESSION_NEWS_INFO_ID = #{professionNewsInfoId}
</select>
    <!-- 通讯录列表查询 -->
    <select id="queryListComRoster" parameterType="java.util.Map"
	resultType="java.util.Map">
			SELECT
				a.AGENT_ID 'agentID',
				a.AGENT_NAME 'chnName',
				a.OFFICE_TEL 'officeTel',
				a.MOBILE 'mobile',
				a.EMAIL 'email',
				a.COM_ID 'comID',
				(SELECT COM_NAME FROM T_DEF_COM WHERE COM_ID = A.COM_ID) 'comName',
				(SELECT
			max(c.POSITION_CODE)
			FROM
			t_agent_position_trace c
			WHERE
			a.AGENT_ID = c.AGENT_ID
			AND c.RC_STATE = 'E'
			) 'positioncode',
				FUNC_GET_CODE_NAME (
					'positionCode',
					(SELECT
			max(c.POSITION_CODE)
			FROM
			t_agent_position_trace c
			WHERE
			a.AGENT_ID = c.AGENT_ID
			AND c.RC_STATE = 'E'
			)
				) 'positionName'
			FROM
				t_agent a
			WHERE
					a.RC_STATE = 'E'
			<include refid="queryListComRosterCondition" />
			LIMIT #{startIndex} , #{endIndex}
</select>
	<select id="queryListComRosterCount" parameterType="java.util.Map"
		resultType="java.lang.Integer">
		SELECT COUNT(1)
		FROM
			 t_agent a
		WHERE
			 a.RC_STATE = 'E'
		<include refid="queryListComRosterCondition" />
	</select> 
	<select id="queryProfessionNewsList" parameterType="java.util.Map"
	resultType="java.util.Map">
	SELECT a.PROFESSION_NEWS_INFO_ID 'professionNewsInfoId',
	a.TITLE 'title',
  DATE_FORMAT(a.MODIFY_DATE,'%Y-%m-%d') 'modifyDate'
	from t_profession_news_info a
	where 1=1
	and a.RC_STATE = 'E'
	ORDER BY a.MODIFY_DATE DESC
	LIMIT #{startIndex} , #{endIndex}
    </select>
    <select id="queryProfessionNewsListCount" parameterType="java.util.Map"
	resultType="java.lang.Integer">
	SELECT count(1)
	from t_profession_news_info a
	where 1=1
	and a.RC_STATE = 'E'
    </select>
    
<!-- 获取公司要闻列表 -->
<select id="queryCompanyNewsList" parameterType="java.util.Map" resultType="java.util.Map">
         		SELECT
	a.COMPANY_NEWS_INFO_ID 'companyNewsInfoId',
	a.TITLE 'title',
  DATE_FORMAT(a.MODIFY_DATE,'%Y-%m-%d') 'modifyDate'
FROM
	t_company_news_info a
WHERE
	1 = 1
AND a.RC_STATE = 'E'
ORDER BY
	a.MODIFY_DATE DESC
LIMIT #{startIndex} , #{endIndex} 
    </select> 
    
    <select id="queryCompanyNewsListCount" parameterType="java.util.Map" resultType="java.lang.Integer">
		SELECT COUNT(1)
        FROM t_company_news_info a
        WHERE 1=1
        AND A.RC_STATE = 'E'
    </select> 
        <!-- 获取公司要闻内容 -->
 <select id="getCompanyNewsContext" parameterType="java.util.Map" resultType="java.util.Map">
         		SELECT
	
	a.TITLE 'title',
	a.CONTENT 'context'
FROM
	t_company_news_info a
WHERE
	1 = 1
AND a.RC_STATE = 'E'
AND a.COMPANY_NEWS_INFO_ID = #{companyNewsInfoId}
    </select> 
    <!-- 获取公司政策列表 -->
<select id="queryEditorProNewsList" parameterType="java.util.Map" resultType="java.util.Map">
         		SELECT
	a.PROFESSION_NEWS_INFO_ID 'professionNewsInfoId',
	a.TITLE 'title',
  DATE_FORMAT(a.MODIFY_DATE,'%Y-%m-%d') 'modifyDate'
	FROM
	t_profession_news_info a
	WHERE
	1 = 1
	AND a.RC_STATE = 'E'
	ORDER BY
	a.MODIFY_DATE DESC
	LIMIT #{startIndex} , #{endIndex}
</select> 
    
    <select id="queryEditorProNewsListCount" parameterType="java.util.Map" resultType="java.lang.Integer">
		SELECT COUNT(1)
        FROM t_profession_news_info a
        WHERE 1=1
        AND A.RC_STATE = 'E'
    </select> 
    
    <select id="querySelfIntroductionText" parameterType="java.util.Map" resultType="java.lang.String">
    	SELECT SELF_INTRODUCTION 
    	FROM t_agent a
    	WHERE A.RC_STATE = 'E'
    	AND USER_ID=#{userId} 
    </select>
</mapper>